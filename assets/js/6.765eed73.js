(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{309:function(e,t,n){e.exports=n.p+"assets/img/PISP_Linking__Pre-linking.293de80d.svg"},310:function(e,t,n){e.exports=n.p+"assets/img/PISP_Linking__Discovery.1a31c51d.svg"},311:function(e,t,n){e.exports=n.p+"assets/img/PISP_Linking__Request_consent_(Web).f9e2fc6c.svg"},312:function(e,t,n){e.exports=n.p+"assets/img/PISP_Linking__Request_consent_(OTP).ffa400a3.svg"},313:function(e,t,n){e.exports=n.p+"assets/img/PISP_Linking__Authentication_(Web).5e415975.svg"},314:function(e,t,n){e.exports=n.p+"assets/img/PISP_Linking__Authentication_(OTP).aaadba47.svg"},315:function(e,t,n){e.exports=n.p+"assets/img/PISP_Linking__Grant_consent.c12f52ec.svg"},316:function(e,t,n){e.exports=n.p+"assets/img/PISP_Linking__Credential_registration_(challenge).c2700881.svg"},317:function(e,t,n){e.exports=n.p+"assets/img/PISP_Linking__Credential_registration_(verification).5a2d456f.svg"},318:function(e,t,n){e.exports=n.p+"assets/img/PISP_Linking__Unlinking.7088d65b.svg"},319:function(e,t,n){e.exports=n.p+"assets/img/PISP_Linking__Authentication_(Third-party_FIDO_registration).af651c17.svg"},360:function(e,t,n){"use strict";n.r(t);var i=n(43),a=Object(i.a)({},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[i("h1",[e._v("Contents")]),e._v(" "),i("ul",[i("li",[i("a",{attrs:{href:"#1-linking"}},[e._v("1. Linking")]),e._v(" "),i("ul",[i("li",[i("a",{attrs:{href:"#11-pre-linking"}},[e._v("1.1. Pre-linking")])]),e._v(" "),i("li",[i("a",{attrs:{href:"#12-discovery"}},[e._v("1.2. Discovery")])]),e._v(" "),i("li",[i("a",{attrs:{href:"#13-request-consent"}},[e._v("1.3. Request consent")]),e._v(" "),i("ul",[i("li",[i("a",{attrs:{href:"#131-web"}},[e._v("1.3.1. Web")])]),e._v(" "),i("li",[i("a",{attrs:{href:"#132-otp--sms"}},[e._v("1.3.2. OTP / SMS")])])])]),e._v(" "),i("li",[i("a",{attrs:{href:"#14-authentication"}},[e._v("1.4. Authentication")]),e._v(" "),i("ul",[i("li",[i("a",{attrs:{href:"#141-web"}},[e._v("1.4.1. Web")])]),e._v(" "),i("li",[i("a",{attrs:{href:"#142-otp"}},[e._v("1.4.2. OTP")])])])]),e._v(" "),i("li",[i("a",{attrs:{href:"#15-grant-consent"}},[e._v("1.5. Grant consent")])]),e._v(" "),i("li",[i("a",{attrs:{href:"#16-credential-registration"}},[e._v("1.6. Credential registration")]),e._v(" "),i("ul",[i("li",[i("a",{attrs:{href:"#161-requesting-a-challenge"}},[e._v("1.6.1. Requesting a challenge")])]),e._v(" "),i("li",[i("a",{attrs:{href:"#162-finalizing-the-credential"}},[e._v("1.6.2. Finalizing the credential")])])])])])]),e._v(" "),i("li",[i("a",{attrs:{href:"#2-unlinking"}},[e._v("2. Unlinking")])]),e._v(" "),i("li",[i("a",{attrs:{href:"#3-third-party-credential-registration"}},[e._v("3. Third-party credential registration")]),e._v(" "),i("ul",[i("li",[i("a",{attrs:{href:"#31-authentication"}},[e._v("3.1. Authentication")])]),e._v(" "),i("li",[i("a",{attrs:{href:"#32-credential-registration"}},[e._v("3.2. Credential registration")])])])])]),e._v(" "),i("h1",{attrs:{id:"_1-linking"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_1-linking"}},[e._v("#")]),e._v(" 1. Linking")]),e._v(" "),i("p",[e._v("The goal of the linking process is to explain how users establish trust between\nall three interested parties:")]),e._v(" "),i("ol",[i("li",[e._v("User")]),e._v(" "),i("li",[e._v("DFSP where User has an account")]),e._v(" "),i("li",[e._v("PISP that User wants to rely on to initiate payments")])]),e._v(" "),i("p",[i("em",[e._v("NOTE: For now, we're focusing on the FIDO / Web authentication channel.")])]),e._v(" "),i("p",[e._v("Linking is broken down into several separate phases:")]),e._v(" "),i("ol",[i("li",[i("strong",[e._v("Pre-linking")]),e._v("\nIn this phase, a PISP asks what DFSPs are available to link with.")]),e._v(" "),i("li",[i("strong",[e._v("Request consent")]),e._v("\nIn this phase, a PISP attempts to establish trust between the 3 parties.")]),e._v(" "),i("li",[i("strong",[e._v("Authentication")]),e._v("\nIn this phase, a User proves their identity to their DFSP.")]),e._v(" "),i("li",[i("strong",[e._v("Grant consent")]),e._v("\nIn this phase, a PISP proves to the DFSP that the User and PISP have\nestablished trust and, as a result, the DFSP confirms that mutual trust\nexists between the 3 parties.")]),e._v(" "),i("li",[i("strong",[e._v("Credential registration")]),e._v("\nIn this phase, a User establishes the credential they'll use to consent to\nfuture transfers from the DFSP and initiated by the PISP.")])]),e._v(" "),i("h2",{attrs:{id:"_1-1-pre-linking"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-pre-linking"}},[e._v("#")]),e._v(" 1.1. Pre-linking")]),e._v(" "),i("p",[e._v("In this phase, a PISP Server needs to know what DFSPs are available to link\nwith. This is "),i("em",[e._v("unlikely")]),e._v(' to be done on-demand (e.g., when a User clicks "link"\nin the PISP mobile App), and far more likely to be done periodically and cached\nby the PISP Server. The reason for this is simply that new DFSPs don\'t typically\njoin the Mojaloop network all that frequently, so calling this multiple times on\nthe same day (or even the same month) would likely yield the same results.')]),e._v(" "),i("p",[e._v("The end-goal of this phase is for the PISP Server to have a final list of DFSPs\navailable and any relevant metadata about those DFPSs that are necessary to\nbegin the linking process.")]),e._v(" "),i("p",[i("img",{attrs:{src:n(309),alt:"Pre-linking"}})]),e._v(" "),i("h2",{attrs:{id:"_1-2-discovery"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-discovery"}},[e._v("#")]),e._v(" 1.2. Discovery")]),e._v(" "),i("p",[e._v("In this phase, we ask the user for the identifier they use with the DFSP they\nintend to link with. This could be a username, MSISDN (phone number), or email\naddress.")]),e._v(" "),i("p",[e._v("The result of this phase is a list of potential accounts available for linking.\nThe user will then choose one or more of these source accounts and the PISP will\nprovide these to the DFSP when requesting consent.")]),e._v(" "),i("p",[i("strong",[e._v("NOTE:")]),e._v(" When using the Web authentication channel, it's possible that the\nchoices made (i.e., the accounts to link with) will be overridden by the user in\na web view. In other words, the user may decide during the Authentication phase\nthat they actually would like to link a different account than those chosen at\nthe very beginning. This is perfectly acceptable and should be expected from\ntime to time.")]),e._v(" "),i("p",[i("img",{attrs:{src:n(310),alt:"Discovery"}})]),e._v(" "),i("h2",{attrs:{id:"_1-3-request-consent"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-request-consent"}},[e._v("#")]),e._v(" 1.3. Request consent")]),e._v(" "),i("p",[e._v("In this phase, a PISP is asking a specific DFSP to start the process of\nestablishing consent between three parties:")]),e._v(" "),i("ol",[i("li",[e._v("The PISP")]),e._v(" "),i("li",[e._v("The specified DFSP")]),e._v(" "),i("li",[e._v("A User that is presumed to be a customer of the DFSP in (2)")])]),e._v(" "),i("p",[e._v("The PISPs request to establish consent must include a few important pieces of\ninformation:")]),e._v(" "),i("ul",[i("li",[e._v("The authentication channels that are acceptable to the User")]),e._v(" "),i("li",[e._v("The scopes required as part of the consent (in this case, almost always just\nthe ability to view a balance of a specific account and send funds from an\naccount).")])]),e._v(" "),i("p",[e._v("Some information depends on the authentication channel used (either web or OTP).\nSpecically, if the web authentication channel is used, the following extra\ninformation is required:")]),e._v(" "),i("ul",[i("li",[e._v("A callback URI of where a user can be redirected with any extra information.")])]),e._v(" "),i("p",[e._v("The end result of this phase depends on the authentication channel used:")]),e._v(" "),i("h3",{attrs:{id:"_1-3-1-web"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-web"}},[e._v("#")]),e._v(" 1.3.1. Web")]),e._v(" "),i("p",[e._v("In the web authentication channel, the result is the PISP being instructed on\na specific URL where this supposed user should be redirected. This URL should be\na place where the user can prove their identity (e.g., by logging in).")]),e._v(" "),i("p",[i("img",{attrs:{src:n(311),alt:"Request consent"}})]),e._v(" "),i("h3",{attrs:{id:"_1-3-2-otp-sms"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-otp-sms"}},[e._v("#")]),e._v(" 1.3.2. OTP / SMS")]),e._v(" "),i("p",[e._v("In the OTP authentication channel, the result is the PISP being instructed on\na specific URL where this supposed user should be redirected. This URL should be\na place where the user can prove their identity (e.g., by logging in).")]),e._v(" "),i("p",[i("img",{attrs:{src:n(312),alt:"Request consent"}})]),e._v(" "),i("h2",{attrs:{id:"_1-4-authentication"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-authentication"}},[e._v("#")]),e._v(" 1.4. Authentication")]),e._v(" "),i("p",[e._v("In the authentication phase, the user is expected to prove their identity to the\nDFSP. Once this is done, the DFSP will provide the User with some sort of secret\n(e.g., an OTP or access token). This secret will then be passed along to the\nPISP so that the PISP can demonstrate a chain of trust:")]),e._v(" "),i("ul",[i("li",[e._v("The DFSP trusts the User")]),e._v(" "),i("li",[e._v("The DFSP gives the User a secret")]),e._v(" "),i("li",[e._v("The User trusts the PISP")]),e._v(" "),i("li",[e._v("The User gives the PISP the secret that came from the DFSP")]),e._v(" "),i("li",[e._v("The PISP gives the secret to the DFSP")]),e._v(" "),i("li",[e._v("The DFSP verified that the secret is correct")])]),e._v(" "),i("p",[e._v("This chain results in the conclusion: The DFSP can trust the PISP is acting on\nbehalf of the User, and mutual trust exists between all three parties.")]),e._v(" "),i("p",[e._v("The process of establishing this chain of trust depends on the authentication\nchannel being used:")]),e._v(" "),i("h3",{attrs:{id:"_1-4-1-web"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-1-web"}},[e._v("#")]),e._v(" 1.4.1. Web")]),e._v(" "),i("p",[e._v("In the web authentication channel, the user is actually redirected to the DFSP's\nwebsite where they can prove their identity (likely by a typical username and\npassword style login).")]),e._v(" "),i("p",[i("strong",[e._v("Note:")]),e._v(" Keep in mind that at this stage, the User may update their choices of\nwhich accounts to link with. The result of this will be seen later on when\nduring the Grant consent phase, where the DFSP will provide the correct values\nto the PISP in the "),i("code",[e._v("scopes")]),e._v(" field.")]),e._v(" "),i("p",[i("img",{attrs:{src:n(313),alt:"Authentication (Web)"}})]),e._v(" "),i("h3",{attrs:{id:"_1-4-2-otp"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-2-otp"}},[e._v("#")]),e._v(" 1.4.2. OTP")]),e._v(" "),i("p",[e._v("When using the OTP authentication channel, the DFSP will send the User some sort\nof one-time password over a pre-established channel (most likely SMS). The PISP\nshould prompt the user for this secret and then provide that back to the DFSP.")]),e._v(" "),i("p",[i("img",{attrs:{src:n(314),alt:"Authentication (OTP)"}})]),e._v(" "),i("h2",{attrs:{id:"_1-5-grant-consent"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-grant-consent"}},[e._v("#")]),e._v(" 1.5. Grant consent")]),e._v(" "),i("p",[e._v("Now that mutual trust has been established between all three parties, the DFSP\nis able to create a record of that fact by creating a new Consent resource.\nThis resource will store all the relevant information about the relationship\nbetween the three parties, and will eventually contain additional information\nfor how the User can prove that it consents to each individual transfer in the\nfuture.")]),e._v(" "),i("p",[e._v("This phase consists exclusively of the DFSP requesting that a new consent be\ncreated. This request must be conveyed both to the PISP itself and the Auth\nservice which will be the record of trust for these resources.")]),e._v(" "),i("p",[i("img",{attrs:{src:n(315),alt:"Grant consent"}})]),e._v(" "),i("h2",{attrs:{id:"_1-6-credential-registration"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-credential-registration"}},[e._v("#")]),e._v(" 1.6. Credential registration")]),e._v(" "),i("p",[e._v("Once the consent resource has been created, the PISP will attempt to establish\nwith the network the credential that should be used to verify that a user has\ngiven consent for each transfer in the future.")]),e._v(" "),i("p",[e._v("This will be done by storing a FIDO credential (e.g., a public key) on the Auth\nservice inside the consent resource. When future transfers are proposed, we will\nrequire that those transfers be digitally signed by the FIDO credential (in this\ncase, the private key) in order to be considered valid.")]),e._v(" "),i("p",[e._v("This credential registration is composed of two phases: requesting a challenge\nand finalizing the signature.")]),e._v(" "),i("h3",{attrs:{id:"_1-6-1-requesting-a-challenge"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-1-requesting-a-challenge"}},[e._v("#")]),e._v(" 1.6.1. Requesting a challenge")]),e._v(" "),i("p",[e._v("In this sub-phase, the PISP requests a challenge from the Auth service, which\nwill be returned to the PISP via a "),i("code",[e._v("PUT /consents/{ID}")]),e._v(" API call.")]),e._v(" "),i("p",[i("img",{attrs:{src:n(316),alt:"Credential registration: Challenge"}})]),e._v(" "),i("h3",{attrs:{id:"_1-6-2-finalizing-the-credential"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-2-finalizing-the-credential"}},[e._v("#")]),e._v(" 1.6.2. Finalizing the credential")]),e._v(" "),i("p",[e._v("Once the challenge is provided to the PISP, the PISP will generate a new\ncredential on the device, digitally sign the challenge, and provide the some new\ninformation about the credential on the Consent resource:")]),e._v(" "),i("ol",[i("li",[e._v("The credential itself (the public component)")]),e._v(" "),i("li",[e._v("A signature of the challenge (to be verified against this public component)")]),e._v(" "),i("li",[e._v("The ID of the credential understood by the device itself")])]),e._v(" "),i("p",[e._v("This information is provided back to the Auth service, which then verifies that\nthe signature is correct. It then updates the status of the credential to\n"),i("code",[e._v('"VERIFIED"')]),e._v(", and notifies both the PISP and the DFSP about these new changes\nto the Consent resource.")]),e._v(" "),i("p",[i("img",{attrs:{src:n(317),alt:"Credential registration: Register"}})]),e._v(" "),i("h1",{attrs:{id:"_2-unlinking"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_2-unlinking"}},[e._v("#")]),e._v(" 2. Unlinking")]),e._v(" "),i("p",[e._v("At some point in the future, it's possible that a User, PISP, or DFSP may decide\nthat the relationship of trust previously established should no longer exist.\nFor example, a very common scenario might be a user losing their mobile device\nand using an interface from their DFSP to remove the link between the lost\ndevice, the PISP, and the DFSP.")]),e._v(" "),i("p",[e._v("To make this work, we simply need to provide a way for a member on the network\nto remove the Consent resourse and notify the other parties about the removal.")]),e._v(" "),i("p",[i("img",{attrs:{src:n(318),alt:"Credential registration: Register"}})]),e._v(" "),i("h1",{attrs:{id:"_3-third-party-credential-registration"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_3-third-party-credential-registration"}},[e._v("#")]),e._v(" 3. Third-party credential registration")]),e._v(" "),i("p",[e._v("There is ongoing work with the FIDO alliance to allow third parties the ability\nto collect a FIDO credential on behalf of the intended user of the credential.\nIn other words, this work would allow the DFSP (during the web authentication\nflow) to ask the user to provide a FIDO credential that would be for use by the\nPISP rather than the DFSP.")]),e._v(" "),i("p",[e._v("If this becomes possible, the flow changes, speciifcally in the Authentication\nphase and the Credential registration phase.")]),e._v(" "),i("h2",{attrs:{id:"_3-1-authentication"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-authentication"}},[e._v("#")]),e._v(" 3.1. Authentication")]),e._v(" "),i("p",[e._v("The authentication phase becomes very minimal. Since the credential will be\ncollected by the DFSP itself (for use later by the PISP), there's no need to\nsend back any sort of secret and no need to pass a secret back to the DFSP.")]),e._v(" "),i("p",[i("img",{attrs:{src:n(319),alt:"Credential registration: Register"}})]),e._v(" "),i("h2",{attrs:{id:"_3-2-credential-registration"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-credential-registration"}},[e._v("#")]),e._v(" 3.2. Credential registration")]),e._v(" "),i("p",[e._v("TODO!")])])}),[],!1,null,null,null);t.default=a.exports}}]);